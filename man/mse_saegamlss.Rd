% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mse_saegamlss.R
\name{mse_saegamlss}
\alias{mse_saegamlss}
\title{Bootstrap Mean Square Error for SAE GAMLSS}
\usage{
mse_saegamlss(
  est,
  loop = NULL,
  l,
  Iden = F,
  data,
  cov1,
  cov2 = NULL,
  cov3 = NULL,
  cov4 = NULL,
  seed = 124
)
}
\arguments{
\item{est}{An object obtained with est_saegamlss()}

\item{loop}{Number of loop of bootstrap. Default is 200}

\item{l}{A vector, of maximum length equal to 4, in which each space is a function (the inverse of the link-function) to be applied to the corresponding parameter, i.e. mu, sigma, nu and tau}

\item{Iden}{TRUE if the Identity link function is used for mu. Default is FALSE}

\item{data}{A dataset. Mandatory columns: covariates and areas (named sa). Additional columns are admitted.}

\item{cov1}{A matrix or a data frame with covariates for the whole population used for mu. If an intercept is used the first columns have to be a vector of 1}

\item{cov2}{A matrix or a data frame with covariates for the whole population used for sigma. If an intercept is used the first columns have to be a vector of 1}

\item{cov3}{A matrix or a data frame with covariates for the whole population used for nu. If an intercept is used the first columns have to be a vector of 1}

\item{cov4}{A matrix or a data frame with covariates for the whole population used for tau. If an intercept is used the first columns have to be a vector of 1}

\item{seed}{The seed. Default is 124}
}
\value{
an object of class "saegamlss_class" containing the MSE of the mean or/and HCR for each area
 and all the values returned by est_saegamlss()
}
\description{
Compute the bootstrap MSE for the estimation of the mean and the HCR
}
\examples{

dep.y <- data_gen(
  Ni = rep(10, 4), D = 4, M = 1, ty = "no", k = 4, b1 = 100,
  x1 = rnorm(40, 0, 1), b2 = NULL, x2 = NULL, b3 = NULL,
  x3 = NULL, b4 = NULL, x4 = NULL, xh = NULL,
  Dis, l = c(identity), sigma = 6, sigmah = NULL,
  sigmae = 22, costh = NULL, seed = 1234
)
data <- dep.y[[1]]
#
# sample data with a sample fraction of 0.5
#
library(splitstackshape)
# sample data
#
sample <- stratified(data, "sa", size = 0.5)
# nonsample data
#
nonsample <- subset(data, !(data$id\%in\%sample$id))
# estimate
est <- est_saegamlss(
  sample = sample, nonsample = nonsample, y_dip="y", sa="sa",
  Ni = rep(10, 4), ni = rep(1, 4), f1 = y ~ x1 + random(sa),
  f2 = NULL, f3 = NULL, f4 = NULL, fdis = NO,
  R = 2, Dis = rNO, np = 2, param = NULL,
  seed = 1234, tau.fix = NULL, nu.fix = NULL
)
#
# covariates
#
x <- data.frame(rep(1, nrow(data)), "x1" = data$x1)
#
# compute the MSE
#
MSE <- mse_saegamlss(
  est = est, loop = 2,
  l = c(identity), Iden = TRUE,
  data = data, cov1 = x, cov2 = NULL, cov3 = NULL,
  cov4 = NULL, seed = 1234
)
MSE$est_mse$MSE_mean
MSE$est_mse$MSE_HCR

}
\references{
Mori, L., & Ferrante, M. R. (2023). Small area estimation under unit-level generalized additive models for location, scale and shape. arXiv e-prints, arXiv-2302.
 Graf, M., Marin, J. M., & Molina, I. (2019). A generalized mixed model for skewed distributions applied to small area estimation. Test, 28(2), 565â€“597.
}
\author{
Lorenzo Mori and Maria Rosaria Ferrante
}
